document.addEventListener("DOMContentLoaded",function(m){(function(){const r=document.querySelector("#formAccountSettings"),e=document.querySelector("#formAccountDeactivation"),o=e==null?void 0:e.querySelector(".deactivate-account"),s=document.querySelector("#formChangePassword"),l=document.querySelector("#formEnable2fa"),u=document.querySelector("#disable2faButton");r&&FormValidation.formValidation(r,{fields:{name:{validators:{notEmpty:{message:"Please enter first name"}}},email:{validators:{notEmpty:{message:"Please enter email."},emailAddress:{message:"Please enter a valid email."}}},role:{validators:{notEmpty:{message:"Please select a role."}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:".col-md-6"}),submitButton:new FormValidation.plugins.SubmitButton,defaultSubmit:new FormValidation.plugins.DefaultSubmit,autoFocus:new FormValidation.plugins.AutoFocus}}),s&&FormValidation.formValidation(s,{fields:{old_password:{validators:{notEmpty:{message:"Please enter your current password."}}},password:{validators:{notEmpty:{message:"Enter a new password."}}},password_confirmation:{validators:{notEmpty:{message:"Repeat new password same here."},identical:{compare:function(){return s.querySelector('[name="password_confirmation"]').value},message:"The password and its confirm are not the same"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,submitButton:new FormValidation.plugins.SubmitButton,defaultSubmit:new FormValidation.plugins.DefaultSubmit,autoFocus:new FormValidation.plugins.AutoFocus,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:".mb-3"})}}),l&&FormValidation.formValidation(l,{fields:{"2fa_password":{validators:{notEmpty:{message:"The password field is required."}}},code:{validators:{notEmpty:{message:"The code field is required."},number:{message:"Please enter digits only."}}}},plugins:{trigger:new FormValidation.plugins.Trigger,submitButton:new FormValidation.plugins.SubmitButton,autoFocus:new FormValidation.plugins.AutoFocus,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:".form-input"})}}).on("core.form.valid",function(){let t=$("#formEnable2fa");$.ajax({url:t.attr("action"),type:"POST",data:t.serialize(),success:function(i){i.verified?document.location.href=i.data.url:($(".form-input").html(`<div style="background-color: #fff; padding: 30px">${i}</div>`),$("#2fa_setup_instruction").removeClass("d-none"),$(".form-input").addClass("col-md-6").append(`<label for="code" class="form-label">Code</label>
                                    <input class="form-control" type="number" id="code" name="code"/>`))},error:function(i){$("#2fa_password").addClass("is-invalid").closest(".form-input").addClass("fv-plugins-icon-container fv-plugins-bootstrap5-row-invalid").find(".invalid-feedback").append('<div data-field="2fa_password" data-validator="notEmpty">Password you entered is incorrect.</div>')}})}),e&&FormValidation.formValidation(e,{fields:{accountActivation:{validators:{notEmpty:{message:"Please confirm you want to delete account"}}},password:{validators:{notEmpty:{message:"Please enter Password"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:".col-md-6"}),submitButton:new FormValidation.plugins.SubmitButton,fieldStatus:new FormValidation.plugins.FieldStatus({onStatusChanged:function(t){t?o.removeAttribute("disabled"):o.setAttribute("disabled","disabled")}}),autoFocus:new FormValidation.plugins.AutoFocus}});const d=document.querySelector("#accountActivation");o&&(o.onclick=function(){d.checked===!0&&Swal.fire({text:"Are you sure you would like to deactivate your account?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",customClass:{confirmButton:"btn btn-primary me-2",cancelButton:"btn btn-label-secondary"},buttonsStyling:!1}).then(function(t){t.value&&$("#formAccountDeactivation").submit()})}),u&&(u.onclick=function(){Swal.fire({text:"Are you sure!, you want to disable 2FA.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",customClass:{confirmButton:"btn btn-primary me-2",cancelButton:"btn btn-label-secondary"},buttonsStyling:!1}).then(function(t){t.value&&$("#disable2faForm").submit()})});let a=document.getElementById("uploadedAvatar");const n=document.querySelector(".account-file-input"),c=document.querySelector(".account-image-reset");if(a){const t=a.src;n.onchange=()=>{n.files[0]&&(a.src=window.URL.createObjectURL(n.files[0]))},c.onclick=()=>{n.value="",a.src=t}}})()});
